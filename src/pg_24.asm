!macro InsertModPG24 {
; ------------------------------------------------------------
; Native PG-24 (24-pin) patch stub + data
; Free space: $9C39-$9FFF  (ROML visible at $8000-$9FFF)
; ------------------------------------------------------------

pg24_boot:
    ; save ZP used by copier
    LDA $02 : PHA
    LDA $03 : PHA
    LDA $04 : PHA
    LDA $05 : PHA
    LDA $06 : PHA
    LDA $07 : PHA

    ; --- set vectors exactly like pg-24 result ---
    LDA #$90 : STA $031A     ; $1490
    LDA #$14 : STA $031B

    LDA #$AA : STA $0E28     ; $14AA
    LDA #$14 : STA $0E29

    ; --- copy block $148E-$16FF (626 bytes = $0272) ---
    LDA #<pg24_blk_148e : STA $02
    LDA #>pg24_blk_148e : STA $03
    LDA #<$148E        : STA $04
    LDA #>$148E        : STA $05
    LDA #<$0272        : STA $06
    LDA #>$0272        : STA $07
    JSR pg24_copy_len

    ; --- copy $1710-$1712 (3 bytes) ---
    LDA #<pg24_blk_1710 : STA $02
    LDA #>pg24_blk_1710 : STA $03
    LDA #<$1710         : STA $04
    LDA #>$1710         : STA $05
    LDA #$03            : STA $06
    LDA #$00            : STA $07
    JSR pg24_copy_len

    ; --- copy $1726 (1 byte) ---
    LDA #<pg24_blk_1726 : STA $02
    LDA #>pg24_blk_1726 : STA $03
    LDA #<$1726         : STA $04
    LDA #>$1726         : STA $05
    LDA #$01            : STA $06
    LDA #$00            : STA $07
    JSR pg24_copy_len

    ; --- copy $1738 (1 byte) ---
    LDA #<pg24_blk_1738 : STA $02
    LDA #>pg24_blk_1738 : STA $03
    LDA #<$1738         : STA $04
    LDA #>$1738         : STA $05
    LDA #$01            : STA $06
    LDA #$00            : STA $07
    JSR pg24_copy_len

    ; --- copy $1740-$178D (78 bytes = $004E) ---
    LDA #<pg24_blk_1740 : STA $02
    LDA #>pg24_blk_1740 : STA $03
    LDA #<$1740         : STA $04
    LDA #>$1740         : STA $05
    LDA #<$004E         : STA $06
    LDA #>$004E         : STA $07
    JSR pg24_copy_len

    ; --- copy $FD30-$FD4F (32 bytes = $0020) ---
    LDA #<pg24_blk_fd30 : STA $02
    LDA #>pg24_blk_fd30 : STA $03
    LDA #<$FD30         : STA $04
    LDA #>$FD30         : STA $05
    LDA #$20            : STA $06
    LDA #$00            : STA $07
    JSR pg24_copy_len

    ; restore ZP
    PLA : STA $07
    PLA : STA $06
    PLA : STA $05
    PLA : STA $04
    PLA : STA $03
    PLA : STA $02

    JMP $0DA8            ; continue normal Pagefox boot


; ------------------------------------------------------------
; Copy routine: copies ($06/$07) bytes from ($02/$03) -> ($04/$05)
; Uses Y, auto-increments high bytes on page wrap
; ------------------------------------------------------------
pg24_copy_len:
    LDY #$00
.pg24_loop:
    LDA ($02),Y
    STA ($04),Y
    INY
    BNE .pg24_dec
    INC $03
    INC $05
.pg24_dec:
    DEC $06
    BNE .pg24_loop
    LDA $07
    BEQ .pg24_done
    DEC $07
    JMP .pg24_loop
.pg24_done:
    RTS


; ------------------------------------------------------------
; Data blobs (taken from RAM AFTER pg-24 installation)
; ------------------------------------------------------------

pg24_blk_1710:
    !by $10,$51,$75

pg24_blk_1726:
    !by $14

pg24_blk_1738:
    !by $27

pg24_blk_1740:
    !by $10,$08,$04,$02,$01,$80,$40,$20
    !by $08,$10,$20,$40,$80,$01,$02,$04
    !by $C9,$93,$27,$4E,$9C,$39,$72,$E4
    !by $08,$08,$08,$FF,$80,$80,$80,$08
    !by $1C,$22,$C1,$80,$00,$00,$00,$00
    !by $00,$00,$00,$00,$00,$00,$00,$00
    !by $00,$00,$00,$00,$00,$00,$00,$00
    !by $00,$00,$00,$00,$00,$00,$00,$00
    !by $00,$00,$00,$00,$00,$00

pg24_blk_fd30:
    !by $31,$EA,$66,$FE,$47,$FE,$4A,$F3
    !by $91,$F2,$0E,$F2,$50,$F2,$33,$F3
    !by $57,$F1,$CA,$F1,$ED,$F6,$3E,$F1
    !by $2F,$F3,$66,$FE,$A5,$F4,$ED,$F5

pg24_blk_148e:
    !by $68,$40,$BA,$BD,$07,$01,$C9,$5B
    !by $D0,$0F,$BD,$08,$01,$C9,$B0,$D0
    !by $08,$A2,$78,$A0,$3C,$86,$73,$84
    !by $74,$4C,$4A,$F3,$A9,$00,$8D,$15
    !by $D0,$20,$F8,$9A,$B0,$2C,$AD,$09
    !by $17,$8D,$44,$03,$AE,$05,$17,$BD
    !by $10,$17,$85,$1F,$E0,$04,$B0,$10
    !by $29,$10,$D0,$06,$20,$D9,$98,$4C
    !by $D9,$14,$20,$EB,$14,$4C,$D9,$14
    !by $20,$39,$9A,$B0,$05,$CE,$44,$03
    !by $D0,$DA,$08,$20,$66,$9B,$A9,$02
    !by $8D,$15,$D0,$28,$60,$A5,$70,$29
    !by $EF,$C5,$70,$F0,$17,$85,$70,$A0
    !by $0A,$20,$92,$9B,$AD,$08,$17,$F0
    !by $0B,$A0,$0B,$20,$92,$9B,$AD,$08
    !by $17,$20,$65,$16,$A0,$04,$20,$92
    !by $9B,$A9,$00,$85,$25,$A5,$4C,$85
    !by $22,$E6,$25,$38,$20,$EE,$13,$A5
    !by $23,$F0,$09,$20,$8A,$16,$20,$4D
    !by $15,$20,$CC,$9B,$E6,$22,$A5,$4E
    !by $C5,$22,$90,$0E,$20,$E4,$FF,$C9
    !by $B3,$D0,$DE,$20,$41,$98,$90,$D9
    !by $B0,$0C,$A5,$70,$29,$20,$F0,$06
    !by $A9,$0C,$20,$65,$16,$18,$60,$A9
    !by $50,$20,$DC,$9B,$A0,$09,$20,$92
    !by $9B,$A6,$23,$A0,$12,$20,$FB,$96
    !by $86,$1A,$84,$1B,$A5,$1A,$20,$65
    !by $16,$A5,$1B,$20,$65,$16,$A9,$00
    !by $85,$27,$85,$0F,$85,$10,$20,$42
    !by $14,$A9,$08,$85,$26,$A2,$07,$3E
    !by $00,$02,$6A,$CA,$10,$F9,$2E,$08
    !by $02,$20,$95,$15,$C6,$26,$D0,$ED
    !by $C6,$23,$D0,$E2,$A9,$00,$18,$85
    !by $0B,$2A,$85,$0C,$A5,$0D,$85,$1D
    !by $A5,$1F,$29,$40,$F0,$0C,$A5,$0F
    !by $25,$0C,$85,$0D,$A5,$10,$25,$0B
    !by $05,$0D,$85,$0D,$24,$27,$10,$21
    !by $A5,$0F,$20,$E4,$15,$A5,$1F,$29
    !by $20,$F0,$02,$A5,$0D,$85,$1D,$A5
    !by $0F,$20,$E4,$15,$A5,$26,$29,$03
    !by $D0,$07,$A5,$0F,$25,$0B,$20,$E4
    !by $15,$A5,$0B,$85,$0F,$A5,$0C,$85
    !by $10,$A9,$80,$85,$27,$60,$85,$1C
    !by $4A,$4A,$4A,$4A,$AA,$A5,$1D,$4A
    !by $4A,$4A,$4A,$4A,$A8,$BD,$25,$16
    !by $19,$49,$16,$20,$65,$16,$A5,$1C
    !by $4A,$29,$0F,$AA,$A5,$1D,$4A,$4A
    !by $29,$0F,$A8,$BD,$35,$16,$19,$51
    !by $16,$20,$65,$16,$A5,$1C,$29,$03
    !by $AA,$A5,$1D,$29,$03,$A8,$BD,$45
    !by $16,$19,$61,$16,$4C,$65,$16,$00
    !by $00,$06,$07,$18,$18,$1E,$1F,$C0
    !by $C0,$C6,$C7,$F8,$F8,$FE,$FF,$00
    !by $01,$06,$07,$30,$31,$3E,$3F,$C0
    !by $C1,$C6,$C7,$F0,$F1,$FE,$FF,$00
    !by $30,$80,$F0,$00,$03,$0C,$0F,$70
    !by $73,$7C,$7F,$00,$03,$1C,$1F,$60
    !by $63,$7C,$7F,$80,$83,$8C,$8F,$E0
    !by $E3,$FC,$FF,$00,$18,$E0,$F8,$2C
    !by $0F,$17,$10,$03,$4C,$D2,$FF,$48
    !by $8D,$01,$DD,$AD,$0D,$DD,$AD,$00
    !by $DD,$29,$FB,$8D,$00,$DD,$09,$04
    !by $8D,$00,$DD,$AD,$0D,$DD,$29,$10
    !by $F0,$F9,$68,$60,$C6,$25,$F0,$07
    !by $20,$CC,$9B,$C6,$25,$D0,$F9,$60
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$20,$20,$20,$20,$20,$20,$20
    !by $20,$00,$03,$00,$01,$0F,$00,$00
    !by $01,$00,$00,$00,$00,$00,$04,$01
    !by $00,$10,$51,$75,$0A,$00,$00,$00
    !by $FF,$1B,$33,$18,$FF,$1B,$33,$17
    !by $FF,$1B,$33,$16,$FF,$1B,$33,$14
    !by $FF,$1B,$33,$01,$FF,$1B,$2A,$04
    !by $FF,$1B,$5A,$FF,$1B,$4B,$FF,$1B
    !by $2A,$27,$FF,$1B,$40,$FF,$1B,$43
    !by $FF
}